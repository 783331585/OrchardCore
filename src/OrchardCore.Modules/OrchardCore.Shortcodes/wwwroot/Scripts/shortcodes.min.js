jQuery.fn.extend({insertAtCaret:function(e){return this.each((function(o){if(document.selection)this.focus(),sel=document.selection.createRange(),sel.text=e,this.focus();else if(this.selectionStart||"0"===this.selectionStart){var t=this.selectionStart,s=this.selectionEnd,r=this.scrollTop;this.value=this.value.substring(0,t)+e+this.value.substring(s,this.value.length),this.focus(),this.selectionStart=t+e.length,this.selectionEnd=t+e.length,this.scrollTop=r}else this.value+=e,this.focus()}))}});var shortcodeModal,shortcodeApp,shortcodeWrapperTemplate='\n<div class="shortcode-popover-wrapper"></div>\n',shortcodeHolderTemplate='\n<button type="button" class="shortcode-popover-btn btn btn-sm">\n<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n    <path d="M16 4.2v1.5h2.5v12.5H16v1.5h4V4.2h-4zM4.2 19.8h4v-1.5H5.8V5.8h2.5V4.2h-4l-.1 15.6zm5.1-3.1l1.4.6 4-10-1.4-.6-4 10z"></path>\n</svg>\n</button>\n<div class="shortcode-popover-holder mt-n3 mr-n3 py-3 px-2 w-50 bg-white border shadow rounded" style="display:none"></div>  \n';function initializeShortcodesModal(e){if(e){var o=e.id;return shortcodeModal=new Vue({el:"#"+o,data:{selectedValue:""},methods:{init:function(){this.selectedValue=""},insertShortcode:function(e){this.selectedValue=e,$(this.$el).modal("hide")}}}),shortcodeApp}}function initializeShortcodes(e){if(e){var o=e.id,t=Vue.component("vue-multiselect",window.VueMultiselect.default);return shortcodeApp=new Vue({el:"#"+o,components:{"vue-multiselect":t},data:function(){var o=JSON.parse(e.dataset.shortcodes||"[]");return{value:"",selector:"",showControls:!0,shortcodes:o,allShortcodes:o,categories:[]}},methods:{init:function(e,o,t){if(this.value="",this.categories="",this.shortcodes=[],this.showControls=!1,t&&(this.showControls=t),e){if($("#shortcode-popover-app-content").detach().appendTo(e),$(e).addClass("active"),this.selector=e,o){var s=$(o).data("shortcodecategories");s&&(this.shortcodes=this.allShortcodes.filter((function(e){return e.categories.some((function(e){return s.indexOf(e)>-1}))})))}}else alert($("#shortcode-selector-error").data("localized"))},success:function(){$(this.$el).trigger("success"),this.close()},cancel:function(){$(this.$el).trigger("cancel"),this.close()},close:function(){$("#shortcode-popover-app-content").detach().appendTo("#shortcode-popover-app-container"),$("#shortcode-popover-app-content").off()}}})}}function initializeCodeMirrorShortcodeWrapper(e){var o=e.display.wrapper;$(o).wrap(shortcodeWrapperTemplate),$(o).parent().append(shortcodeHolderTemplate),$(o).siblings(".shortcode-popover-btn").on("click",(function(){var o=$(this).siblings(".shortcode-popover-holder");shortcodeApp.init(o,$(this).closest(".shortcode-popover-categories"),!0),o.fadeToggle();var t=function(e){o.is(e.target)||0!==o.has(e.target).length||s()},s=function(){o.fadeToggle(),$(document).off("mouseup",t)};$(document).on("mouseup",t),$("#shortcode-popover-app-content").on("success",(function(){shortcodeApp.value&&shortcodeApp.value.defaultShortcode&&e.replaceSelection(shortcodeApp.value.defaultShortcode),o.fadeToggle(),$(document).off("mouseup",t)})),$("#shortcode-popover-app-content").on("cancel",s)}))}$((function(){$(".shortcode-popover").each((function(){$(this).wrap(shortcodeWrapperTemplate),$(this).parent().append(shortcodeHolderTemplate)})),$(".shortcode-popover-btn").on("click",(function(){var e=$(this).siblings(".shortcode-popover-holder");shortcodeApp.init(e,$(this).siblings(".shortcode-popover"),!0),e.fadeToggle();var o=function(o){e.is(o.target)||0!==e.has(o.target).length||t()},t=function(){e.fadeToggle(),$(document).off("mouseup",o)};$(document).on("mouseup",o),$("#shortcode-popover-app-content").on("success",(function(){shortcodeApp.value&&shortcodeApp.value.defaultShortcode&&$(e).siblings(".shortcode-popover").insertAtCaret(shortcodeApp.value.defaultShortcode);e.fadeToggle(),$(document).off("mouseup",o)})),$("#shortcode-popover-app-content").on("cancel",t)}))}));
